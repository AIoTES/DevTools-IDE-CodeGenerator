<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script type="text/javascript">
    var restObj = {};

	function changeTemplate(){
		restObj.template = document.getElementById("coordinator").value;
	}

    function addRow() {
        var table = document.getElementById("variables_table");
        // Create an empty <tr> element and add it to the 1st position of the table:
        var row = table.insertRow(1);
        var cell1 = row.insertCell(0);
        var cell2 = row.insertCell(1);
        var var_name = document.getElementById("var_name").value;
        var var_val = document.getElementById("var_val").value;
        cell1.innerHTML=var_name;
        cell2.innerHTML=var_val;

        if (!restObj.hasOwnProperty("variables")) {
        	restObj.variables={}
        }
        restObj.variables[var_name]=var_val;
    }
    function addOnt(){
        var table = document.getElementById("ont_table");
        var row = table.insertRow(1);
        var cell1 = row.insertCell(0);
        var cell2 = row.insertCell(1);
        var ont_url = document.getElementById("ontology").value;
        var var_req =""
        if(document.getElementById("ont_recursive").checked){
            var_req="true";
        }else{
            var_req="false";
        }
        cell1.innerHTML=ont_url;
        cell2.innerHTML=var_req;
        var ontology={url:"",recursive:""}
        ontology.url=ont_url;
        ontology.recursive=var_req;
        if (restObj.hasOwnProperty("ontologies")){
        	restObj.ontologies.push(ontology);
        	} else {
        	restObj.ontologies = [ontology];
        	}
    }
    function post() {
    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function() {
         if (this.readyState == 4 && this.status == 200) {
             alert(this.responseText);
         }
    };
    xhttp.open("POST", "/GenerateCode", true);
    xhttp.setRequestHeader("Content-type", "application/json");
    xhttp.send(restObj);
    //TODO get answer and go to answer.
	}
    </script>
</head>
<body>
    <form name="CodeGenerator" method="POST" action="/GenerateCode">
        <input type="hidden" id="json" value=""></input>
        <h1>CodeGenerator tool</h1>
        <p>XML Coordinator url</p>
        <input type="text" id="coordinator" onchange="changeTemplate()"><br>
        <table id="ont_table" border="1px">
            <tr>
                <th>Ontology URL</th>
                <th>Recursive</th>
            </tr>
        </table>
        <fieldset>
        <legend>Ontologies</legend>

        <input type="text" id="ontology"><br>
        <input type="button" onclick="addOnt()" value="add">
        <input type="checkbox"   id="ont_recursive">load recursively<br>

        </fieldset>

        <table id="variables_table" border="1px">
            <tr>
                <th>Variable name</th>
                <th>Variable value</th>
            </tr>
        </table>
        <fieldset>
            <legend>varaibles:</legend>
            Name: <input type="text" id="var_name"><br>
            Value: <input type="text" id="var_val"><br>
        <input type="button" onclick="addRow()" value="add">
        </fieldset>
        <input type="button" value="GenerateCode" onclick="post()">
      </form>
</body>
</html>